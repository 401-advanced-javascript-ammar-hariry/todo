(this["webpackJsonpdemo-context-api"]=this["webpackJsonpdemo-context-api"]||[]).push([[0],{166:function(e,t,a){e.exports=a(318)},195:function(e,t){},197:function(e,t){},211:function(e,t){},213:function(e,t){},241:function(e,t){},243:function(e,t){},244:function(e,t){},249:function(e,t){},251:function(e,t){},258:function(e,t){},260:function(e,t){},278:function(e,t){},281:function(e,t){},297:function(e,t){},300:function(e,t){},317:function(e,t,a){},318:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(37),c=a.n(r),l=a(15),i=a(16),u=a(18),s=a(17),m=a(322),d=a(163),p=a(11),f=a(320),g=a(23),h=a.n(g),E=a(45),v=a(321),b=a(324),O=a(47),y=a.n(O),j="https://api401-todo.herokuapp.com/todo",S=function(e){var t=Object(n.useState)({}),a=Object(p.a)(t,2),o=a[0],r=a[1],c=function(){y.a.get(j).then((function(e){Object.assign({},o);r({});var t=Object.assign({},o);Object.assign.apply(Object,[t].concat([e.data])),r(t)}))};return[o,c,function(e){y.a.post(j,{item:e.item,assignee:e.assignee,difficulty:e.difficulty,complete:e.complete}).then((function(e){console.log(e),console.log(e.data)}))},function(e){y.a.delete("".concat(j,"/").concat(e)).then((function(e){console.log(e),console.log(e.data)})),c()},function(e,t){y.a.put("".concat(j,"/").concat(t),{item:e.item,assignee:e.assignee,difficulty:e.difficulty,complete:e.complete}).then((function(e){console.log(e),console.log(e.data)})),c()}]};var w=function(e){var t=S(void 0),a=Object(p.a)(t,3),n=(a[0],a[1]),r=a[2],c=function(){var e=Object(E.a)(h.a.mark((function e(t){var a,o,c,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=t.target.text.value,o=t.target.assignee.value,c=t.target.difficulty.value,!1,e.next=7,{item:a,assignee:o,difficulty:c,complete:!1};case 7:l=e.sent,r(l),setTimeout((function(){window.location.reload(!1)}),500),n();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.a.createElement(o.a.Fragment,null,o.a.createElement(v.a,{onSubmit:c},o.a.createElement(v.a.Group,{controlId:"formBasicEmail"},o.a.createElement("h2",null,"Add To Do Item"),o.a.createElement(v.a.Label,null,"To Do Item"),o.a.createElement(v.a.Control,{type:"text",name:"text",placeholder:"Add To Do List Item"})),o.a.createElement(v.a.Group,{controlId:"formBasicPassword"},o.a.createElement(v.a.Label,null,"Assigned To"),o.a.createElement(v.a.Control,{type:"text",name:"assignee",placeholder:"Assigned To"})),o.a.createElement(v.a.Group,{controlId:"formBasicRange"},o.a.createElement(v.a.Label,null,"Range"),o.a.createElement(v.a.Control,{defaultValue:"1",type:"range",min:"1",max:"5",name:"difficulty"})),o.a.createElement(b.a,{variant:"primary",type:"submit",style:{width:"100%"}},"Add Item")))},k=a(323),C=a(164),T=a(85),P=a.n(T),x=a(158),_=a.n(x),I=Object({NODE_ENV:"production",PUBLIC_URL:"/todo",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API||"https://lab32-401.herokuapp.com",D=o.a.createContext(),L=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).login=function(){var e=Object(E.a)(h.a.mark((function e(t,a){var o,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(I,"/signin"),{method:"POST",mode:"cors",cache:"no-cache",headers:new Headers({Authorization:"Basic ".concat(btoa("".concat(t,":").concat(a)))})});case 3:return o=e.sent,e.next=6,o.json();case 6:r=e.sent,n.validateToken(r.token),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),alert("invalid user name or password"),console.log("you must sign up");case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a){return e.apply(this,arguments)}}(),n.signup=function(){var e=Object(E.a)(h.a.mark((function e(t){var a,o,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"POST",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(t)},e.prev=1,e.next=4,fetch("".concat(I,"/signup"),a);case 4:return o=e.sent,e.next=7,o.json();case 7:r=e.sent,n.validateToken(r.token),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),alert("username is already exists"),console.log("somthing went wrong");case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),n.logout=function(){n.setLoginState(!1,null,{})},n.validateToken=function(e){try{var t=_.a.verify(e,Object({NODE_ENV:"production",PUBLIC_URL:"/todo",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_SECRET||"supersecret");n.setLoginState(!0,e,t)}catch(a){n.logout(),alert("invalid user name or password"),console.log("token Validation error")}},n.setLoginState=function(e,t,a){P.a.save("auth",t),n.setState({token:t,loggedIn:e,user:a})},n.state={loggedIn:!1,login:n.login,logout:n.logout,signup:n.signup,user:{}},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=P.a.load("auth")||null;this.validateToken(e)}},{key:"render",value:function(){return o.a.createElement(D.Provider,{value:this.state},this.props.children)}}]),a}(o.a.Component),N=function(e){return e.condition?e.children:null},A=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=!1;try{e=this.context.loggedIn&&(!this.props.capability||this.context.user.capabilities.includes(this.props.capability)),console.log("okToRender: ",e)}catch(t){console.warn("Not Authorized!")}return o.a.createElement(N,{condition:e},this.props.children)}}]),a}(o.a.Component);A.contextType=D;var R=A,B=(a(156),o.a.createContext());var G,U=function(e){var t=Object(n.useState)(3),a=Object(p.a)(t,2),r=a[0],c=a[1],l=Object(n.useState)(!1),i=Object(p.a)(l,2),u={itemsPerPage:r,changePageNumber:c,show:i[0],setShow:i[1]};return o.a.createElement(B.Provider,{value:u},e.children)};var H=function(e){var t=Object(n.useContext)(B),a=Object(n.useState)(0),r=Object(p.a)(a,2),c=r[0],l=r[1];return function(a){var n=e.list.filter((function(e){return!t.show||!e.complete})),o=Math.floor(n.length/a+(n.length%a>0?1:0));G=new Array(o).fill(0)}(t.itemsPerPage),o.a.createElement(o.a.Fragment,null,o.a.createElement("ul",null,e.list.sort((function(e,t){return e.difficulty-t.difficulty})).filter((function(e){return!t.show||!e.complete})).slice(c*t.itemsPerPage,c*t.itemsPerPage+t.itemsPerPage).map((function(t,a){var n,r;return n=t.complete?"success":"danger",r=t.complete?"completed":"uncomplete",o.a.createElement(k.a,{key:t._id},o.a.createElement(C.a,{closeButton:!1},o.a.createElement(R,{capability:"update"},o.a.createElement(b.a,{className:"complete",onClick:function(){return e.updateStatus({val:t.item,assignee:t.assignee,difficulty:t.difficulty,complete:!t.complete},t._id)},variant:"".concat(n)},r)," "),o.a.createElement("strong",{className:"mr-auto assign"},t.assignee),o.a.createElement(R,{capability:"delete"},o.a.createElement(b.a,{className:"closedel",variant:"outline-dark",onClick:function(){e.handleDelete(t._id)}},"X "))),o.a.createElement(k.a.Body,{className:"assign"},t.item),o.a.createElement("small",{className:"difficult"},"Difficulty: ",t.difficulty))})),o.a.createElement("div",null,G.map((function(e,t){return o.a.createElement(b.a,{className:"closedel",key:t,onClick:function(){!function(e){l(e)}(t)}},t)})))))},K=(a(317),0);var W=function(){var e=S(void 0),t=Object(p.a)(e,5),a=t[0],r=t[1],c=(t[2],t[3]),l=t[4],i=[];Object.keys(a).map((function(e,t){i.push(a[e])})),0===K&&(console.log("im here"),r(),K++);var u=Object(n.useState)([]),s=Object(p.a)(u,2),g=s[0],h=s[1],E=Object(n.useState)(0),v=Object(p.a)(E,2),b=v[0],O=v[1];return Object(n.useEffect)((function(){O(Object.keys(a).filter((function(e){return!a[e].complete})).length),document.title="".concat(b," Uncompleted Tasks")}),[b,a]),o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a,null,o.a.createElement(m.a,{bg:"dark",variant:"dark",style:{marginTop:"2em"}},o.a.createElement(m.a.Brand,null,"To DO Manager (",b,") ")),o.a.createElement("section",{className:"todo"},o.a.createElement("div",{className:"form-border"},o.a.createElement(w,{handleSubmit:function(e){e._id=Math.random(),e.complete=!1,e&&h([].concat(Object(d.a)(g),[e]))}})),o.a.createElement("div",{className:"list-group"},o.a.createElement(H,{list:i,handleDelete:function(e){console.log(e),c(e),setTimeout((function(){window.location.reload(!1)}),500)},updateStatus:function(e,t){l(e,t),r()}})))))},F=a(161),V=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleChange=function(e){n.setState(Object(F.a)({},e.target.name,e.target.value))},n.handleSubmit=function(e){e.preventDefault(),n.context.login(n.state.username,n.state.password)},n.state={username:"",password:""},n}return Object(i.a)(a,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(N,{condition:this.context.loggedIn},o.a.createElement("button",{onClick:this.context.logout},"Logout")),o.a.createElement(N,{condition:!this.context.loggedIn},o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("input",{placeholder:"userName",name:"username",onChange:this.handleChange}),o.a.createElement("input",{placeholder:"password",name:"password",onChange:this.handleChange}),o.a.createElement("button",null,"Login"))))}}]),a}(o.a.Component);V.contextType=D;var M=V,J=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).signUpSubmit=function(e){e.preventDefault();var t={password:e.target.Password.value,username:e.target.username.value,role:e.target.role.value,email:e.target.email.value};n.context.signup(t)},n.state={body:""},n}return Object(i.a)(a,[{key:"render",value:function(){return o.a.createElement(N,{condition:!this.context.loggedIn},o.a.createElement(v.a,{onSubmit:this.signUpSubmit},o.a.createElement(v.a.Row,null,o.a.createElement(v.a.Group,{controlId:"formGridEmail"},o.a.createElement(v.a.Label,null,"Username"),o.a.createElement(v.a.Control,{type:"username",placeholder:"Enter Username",name:"username"})),o.a.createElement(v.a.Group,{controlId:"formGridPassword"},o.a.createElement(v.a.Label,null,"Password"),o.a.createElement(v.a.Control,{type:"password",placeholder:"Password",name:"Password"})),o.a.createElement(v.a.Group,{controlId:"formGridPassword"},o.a.createElement(v.a.Label,null,"Email"),o.a.createElement(v.a.Control,{type:"Email",placeholder:"Email",name:"email"}))),o.a.createElement(v.a.Row,null,o.a.createElement(v.a.Group,{controlId:"formGridState"},o.a.createElement(v.a.Label,null,"Role"),o.a.createElement(v.a.Control,{as:"select",defaultValue:"Choose...",name:"role"},o.a.createElement("option",null,"admin"),o.a.createElement("option",null,"user"),o.a.createElement("option",null,"guest")))),o.a.createElement(b.a,{variant:"primary",type:"submit"},"Submit")))}}]),a}(o.a.Component);J.contextType=D;var z=J,X=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return o.a.createElement(U,null,o.a.createElement(L,null,o.a.createElement(m.a,{bg:"primary",variant:"dark"},o.a.createElement(m.a.Brand,null,"Home"),o.a.createElement(M,null)),o.a.createElement(R,null,o.a.createElement(W,null)),o.a.createElement(z,null)))}}]),a}(o.a.Component),q=function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(X,null))},Q=document.getElementById("root");c.a.render(o.a.createElement(q,null),Q)}},[[166,1,2]]]);
//# sourceMappingURL=main.97fec0d9.chunk.js.map